# 医生信息管理模块

## 模块概述
负责医生基本信息的增删改查功能，是系统的核心数据管理模块。

## 功能需求

### 1. 医生信息录入
- 支持单个医生信息手动录入
- 支持批量导入Excel/CSV文件
- 数据验证和格式检查
- 重复数据检测

### 2. 医生信息查询
- 分页查询医生列表
- 多条件筛选（姓名、科室、地区、职称、机构）
- 模糊搜索功能
- 排序功能

### 3. 医生信息修改
- 单条记录编辑
- 批量修改功能
- 修改历史记录

### 4. 医生信息删除
- 单条删除（软删除）
- 批量删除
- 删除权限控制

## 数据结构

### 医生信息表 (doctors)
```sql
CREATE TABLE doctors (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    doctor_id VARCHAR(50) UNIQUE NOT NULL,  -- 医生ID
    name VARCHAR(100) NOT NULL,             -- 姓名
    title VARCHAR(50),                      -- 职称
    region VARCHAR(100),                    -- 地区
    department VARCHAR(100),                -- 科室
    institution VARCHAR(200),               -- 机构名称
    account_type VARCHAR(20),               -- 账号性质（头部、腰部、尾部）
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    deleted_at DATETIME NULL                -- 软删除标记
);
```

## API 接口设计

### 后端接口

#### 1. 获取医生列表
```
GET /api/doctors
Query Parameters:
- page: 页码 (default: 1)
- limit: 每页数量 (default: 20)
- name: 姓名搜索
- department: 科室筛选
- region: 地区筛选
- title: 职称筛选
- institution: 机构筛选
- account_type: 账号性质筛选
```

#### 2. 获取单个医生信息
```
GET /api/doctors/{id}
```

#### 3. 创建医生信息
```
POST /api/doctors
Body: {
    "doctor_id": "DOC001",
    "name": "张医生",
    "title": "主任医师",
    "region": "北京",
    "department": "心内科",
    "institution": "北京协和医院",
    "account_type": "头部"
}
```

#### 4. 更新医生信息
```
PUT /api/doctors/{id}
Body: {同创建接口}
```

#### 5. 删除医生信息
```
DELETE /api/doctors/{id}
```

#### 6. 批量导入
```
POST /api/doctors/batch-import
Content-Type: multipart/form-data
Body: file (Excel/CSV)
```

## 前端界面设计

### 1. 医生列表页面
- 搜索栏（姓名、医生ID）
- 筛选器（科室、地区、职称、机构、账号性质）
- 数据表格
- 分页组件
- 操作按钮（新增、编辑、删除、导入）

### 2. 医生信息表格字段
| 字段 | 显示名称 | 类型 | 操作 |
|------|----------|------|------|
| doctor_id | 医生ID | 文本 | 排序 |
| name | 姓名 | 文本 | 排序、搜索 |
| title | 职称 | 文本 | 筛选、排序 |
| region | 地区 | 文本 | 筛选、排序 |
| department | 科室 | 文本 | 筛选、排序 |
| institution | 机构名称 | 文本 | 筛选、排序 |
| account_type | 账号性质 | 标签 | 筛选 |
| actions | 操作 | 按钮组 | 编辑、删除 |

### 3. 新增/编辑表单
- 表单验证
- 必填字段标记
- 保存/取消按钮
- 错误提示

## 文件结构

### 后端文件结构
```
src/
├── handlers/
│   └── doctors.rs              # 医生信息处理器
├── models/
│   └── doctor.rs               # 医生数据模型
├── routes/
│   └── doctors.rs              # 医生相关路由
└── utils/
    └── import.rs               # 批量导入工具
```

### 前端文件结构
```
src/
├── pages/
│   └── doctors/
│       ├── index.html          # 医生列表页面
│       ├── form.html           # 新增/编辑表单
│       └── import.html         # 批量导入页面
├── components/
│   ├── table.js                # 表格组件
│   ├── filter.js               # 筛选组件
│   └── pagination.js           # 分页组件
└── api/
    └── doctors.js              # 医生相关API调用
```

## 技术实现要点

### 后端实现
- 使用 Actix Web 构建 RESTful API
- 使用 SQLite 作为数据存储
- 实现分页查询优化
- 文件上传处理
- 数据验证中间件

### 前端实现
- 响应式表格设计
- 前端数据缓存
- 表单验证
- 文件上传进度显示
- 错误处理和用户提示

## 测试用例

### 单元测试
- 医生信息CRUD操作测试
- 数据验证测试
- 批量导入功能测试

### 集成测试
- API接口测试
- 数据库操作测试
- 文件上传测试

### 前端测试
- 表格功能测试
- 表单验证测试
- 用户交互测试
